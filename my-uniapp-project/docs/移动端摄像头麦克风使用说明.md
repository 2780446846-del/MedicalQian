# ç§»åŠ¨ç«¯æ‘„åƒå¤´å’Œéº¦å…‹é£ä½¿ç”¨è¯´æ˜

## ğŸ“± æ¦‚è¿°

åœ¨ uniapp ä¸­ï¼Œ**å¯ä»¥åœ¨ç§»åŠ¨ç«¯è·å–æ‘„åƒå¤´å’Œéº¦å…‹é£**ï¼Œä½†æ–¹å¼ä¸ H5 ç¯å¢ƒä¸åŒã€‚

## âœ… å¯ä»¥ä½¿ç”¨çš„åœºæ™¯

### 1. **é€‰æ‹©å›¾ç‰‡/è§†é¢‘**ï¼ˆå·²æ”¯æŒï¼‰
- ä½¿ç”¨ `uni.chooseImage()` - é€‰æ‹©å›¾ç‰‡æˆ–æ‹ç…§
- ä½¿ç”¨ `uni.chooseVideo()` - é€‰æ‹©è§†é¢‘æˆ–å½•åˆ¶è§†é¢‘
- è¿™äº› API åœ¨ç§»åŠ¨ç«¯å®Œå…¨æ”¯æŒï¼Œä¼šè‡ªåŠ¨è¯·æ±‚æƒé™

### 2. **å®æ—¶è§†é¢‘é€šè¯**ï¼ˆéœ€è¦é¢å¤–é…ç½®ï¼‰
- **H5 ç¯å¢ƒ**ï¼šä½¿ç”¨ WebRTC APIï¼ˆ`getUserMedia`ï¼‰âœ… å·²æ”¯æŒ
- **APP ç¯å¢ƒ**ï¼šéœ€è¦åŸç”Ÿæ’ä»¶æˆ–ç¬¬ä¸‰æ–¹ SDK
- **å°ç¨‹åºç¯å¢ƒ**ï¼šå¯ä»¥ä½¿ç”¨ `live-pusher`/`live-player` ç»„ä»¶

## ğŸ”§ ç§»åŠ¨ç«¯å®ç°æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ uni APIï¼ˆé€‚åˆé€‰æ‹©åª’ä½“æ–‡ä»¶ï¼‰

```javascript
// é€‰æ‹©å›¾ç‰‡ï¼ˆä¼šè‡ªåŠ¨è¯·æ±‚æ‘„åƒå¤´æƒé™ï¼‰
uni.chooseImage({
  count: 1,
  sourceType: ['camera'], // ç›´æ¥è°ƒç”¨æ‘„åƒå¤´
  success: (res) => {
    console.log('å›¾ç‰‡è·¯å¾„:', res.tempFilePaths[0])
  }
})

// é€‰æ‹©è§†é¢‘ï¼ˆä¼šè‡ªåŠ¨è¯·æ±‚æ‘„åƒå¤´å’Œéº¦å…‹é£æƒé™ï¼‰
uni.chooseVideo({
  sourceType: ['camera'], // ç›´æ¥è°ƒç”¨æ‘„åƒå¤´
  maxDuration: 60, // æœ€é•¿å½•åˆ¶60ç§’
  camera: 'back', // ä½¿ç”¨åç½®æ‘„åƒå¤´
  success: (res) => {
    console.log('è§†é¢‘è·¯å¾„:', res.tempFilePath)
  }
})
```

### æ–¹æ¡ˆäºŒï¼šAPP ç¯å¢ƒä½¿ç”¨åŸç”Ÿæ’ä»¶

#### é€‰é¡¹ Aï¼šä½¿ç”¨ plus APIï¼ˆ5+ Appï¼‰
```javascript
// #ifdef APP-PLUS
// ä½¿ç”¨ plus.camera è·å–æ‘„åƒå¤´
plus.camera.getCamera().captureImage((path) => {
  console.log('æ‹ç…§æˆåŠŸ:', path)
}, (error) => {
  console.error('æ‹ç…§å¤±è´¥:', error)
})
// #endif
```

#### é€‰é¡¹ Bï¼šé›†æˆç¬¬ä¸‰æ–¹ WebRTC SDK
æ¨èä½¿ç”¨ä»¥ä¸‹ SDKï¼š
- **è…¾è®¯äº‘å®æ—¶éŸ³è§†é¢‘ï¼ˆTRTCï¼‰**ï¼šhttps://cloud.tencent.com/product/trtc
- **å£°ç½‘ Agora**ï¼šhttps://www.agora.io/cn/
- **å³æ„ ZEGO**ï¼šhttps://www.zego.im/

### æ–¹æ¡ˆä¸‰ï¼šå°ç¨‹åºç¯å¢ƒä½¿ç”¨ live-pusher ç»„ä»¶

```vue
<!-- å¾®ä¿¡å°ç¨‹åº -->
<live-pusher
  url="rtmp://your-server.com/live"
  mode="RTC"
  enable-camera
  enable-mic
  @statechange="onPusherStateChange"
></live-pusher>

<live-player
  url="rtmp://your-server.com/live"
  mode="RTC"
  @statechange="onPlayerStateChange"
></live-player>
```

## ğŸ“‹ æƒé™é…ç½®

### manifest.json é…ç½®ï¼ˆAPPï¼‰

```json
{
  "app-plus": {
    "distribute": {
      "android": {
        "permissions": [
          "<uses-permission android:name=\"android.permission.CAMERA\"/>",
          "<uses-permission android:name=\"android.permission.RECORD_AUDIO\"/>",
          "<uses-permission android:name=\"android.permission.MODIFY_AUDIO_SETTINGS\"/>"
        ]
      },
      "ios": {
        "privacyDescription": {
          "NSCameraUsageDescription": "éœ€è¦è®¿é—®æ‘„åƒå¤´è¿›è¡Œè§†é¢‘é€šè¯",
          "NSMicrophoneUsageDescription": "éœ€è¦è®¿é—®éº¦å…‹é£è¿›è¡Œè¯­éŸ³é€šè¯"
        }
      }
    }
  }
}
```

### pages.json é…ç½®ï¼ˆå°ç¨‹åºï¼‰

```json
{
  "pages": [
    {
      "path": "pages/video-call/video-call",
      "style": {
        "navigationBarTitleText": "è§†é¢‘é€šè¯"
      }
    }
  ],
  "permission": {
    "scope.camera": {
      "desc": "éœ€è¦è®¿é—®æ‘„åƒå¤´è¿›è¡Œè§†é¢‘é€šè¯"
    },
    "scope.record": {
      "desc": "éœ€è¦è®¿é—®éº¦å…‹é£è¿›è¡Œè¯­éŸ³é€šè¯"
    }
  }
}
```

## ğŸ¯ å½“å‰é¡¹ç›®çŠ¶æ€

### âœ… å·²å®ç°
- H5 ç¯å¢ƒï¼šå®Œæ•´çš„ WebRTC è§†é¢‘é€šè¯åŠŸèƒ½
- ç§»åŠ¨ç«¯ï¼šå›¾ç‰‡/è§†é¢‘é€‰æ‹©åŠŸèƒ½ï¼ˆ`uni.chooseImage`/`uni.chooseVideo`ï¼‰

### âš ï¸ å¾…å®ç°ï¼ˆç§»åŠ¨ç«¯å®æ—¶è§†é¢‘é€šè¯ï¼‰
- APP ç¯å¢ƒï¼šéœ€è¦é›†æˆåŸç”Ÿæ’ä»¶æˆ–ç¬¬ä¸‰æ–¹ SDK
- å°ç¨‹åºç¯å¢ƒï¼šå¯ä»¥ä½¿ç”¨ `live-pusher` ç»„ä»¶

## ğŸ’¡ å»ºè®®

1. **å¦‚æœåªéœ€è¦é€‰æ‹©å›¾ç‰‡/è§†é¢‘**ï¼šä½¿ç”¨ `uni.chooseImage` å’Œ `uni.chooseVideo` âœ…
2. **å¦‚æœéœ€è¦å®æ—¶è§†é¢‘é€šè¯ï¼ˆAPPï¼‰**ï¼š
   - æ¨èä½¿ç”¨è…¾è®¯äº‘ TRTC æˆ–å£°ç½‘ Agora SDK
   - è¿™äº› SDK æä¾›äº†å®Œæ•´çš„ uniapp æ’ä»¶æ”¯æŒ
3. **å¦‚æœéœ€è¦å®æ—¶è§†é¢‘é€šè¯ï¼ˆå°ç¨‹åºï¼‰**ï¼š
   - ä½¿ç”¨å¾®ä¿¡å°ç¨‹åºçš„ `live-pusher` å’Œ `live-player` ç»„ä»¶
   - æˆ–ä½¿ç”¨ç¬¬ä¸‰æ–¹ SDK çš„å°ç¨‹åºç‰ˆæœ¬

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [uni.chooseImage æ–‡æ¡£](https://uniapp.dcloud.net.cn/api/media/image.html#chooseimage)
- [uni.chooseVideo æ–‡æ¡£](https://uniapp.dcloud.net.cn/api/media/video.html#choosevideo)
- [è…¾è®¯äº‘ TRTC uniapp æ’ä»¶](https://cloud.tencent.com/document/product/647/43181)
- [å¾®ä¿¡å°ç¨‹åº live-pusher ç»„ä»¶](https://developers.weixin.qq.com/miniprogram/dev/component/live-pusher.html)
